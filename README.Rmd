---
title: Utility Functions for Simplifying Financial Data Management and Modeling
author: Jerzy Pawlowski (algoquant)
abstract: Functions for managing object names and attributes, applying functions over lists, managing objects in environments.
tags: high frequency, time series, plot, xts
---

[![Build Status](https://travis-ci.org/algoquant/rutils.svg?branch=master)](https://travis-ci.org/algoquant/rutils)


## rutils package for simplifying financial data management and modeling  

========

The **rutils** package contains functions for:

* extracting names and columns from time series, 
* calculating the end points of a time series, 
* applying lags to vectors and matrices, 
* calculating row differences of vectors and matrices, 
* recursively binding a list of objects into time series, 
* recursively applying a function to a list of objects, 
* plotting time series with custom axis range and background shading. 


========

### Installation and loading

Installing **rutils** package from github:  
```
install.packages("devtools")
library(devtools)
install_github(repo="algoquant/rutils")
library(rutils)
```

========

### Data

The **rutils** package contains a dataset of daily *OHLC* time series in *xts* format, for a portfolio of stock symbols.  The time series are contained in an environment called *env_etf*.  
```
# get first six rows of OHLC prices
head(env_etf$VTI)
# plot
chart_Series(x=env_etf$VTI["2009-11"])
```


========

### Examples

Extract the name of an \code{OHLC} time series from its first column name:  
```
# get name for VTI
na_me(env_etf$VTI)
```


Calculate a vector of equally spaced end points for a time
series:  
```
# calculate end points with initial stub interval
end_points(env_etf$VTI, inter_val=7, off_set=4)
```


Extract close prices from an \code{OHLC} time series:  
```
# get close prices for VTI
clo_se(env_etf$VTI)
# get volumes for VTI
clo_se(env_etf$VTI, which_col="vol")
```


Apply a lag to a vector or matrix:  
```
# lag vector by 2 periods
lag_it(1:10, lag=2)
# lag matrix by negative 2 periods
lag_it(matrix(1:10, ncol=2), lag=-2)
```


Calculate the row differences of a vector or matrix:  
```
# diff vector by 2 periods
diff_it(1:10, lag=2)
# diff matrix by negative 2 periods
diff_it(matrix(1:10, ncol=2), lag=-2)
```


Calculate the time differences of an *xts* time series and pad with zeros:  
```
# calculate time differences over lag by 10 periods
rutils::diff.xts(env_etf$VTI, lag=10)
```


Recursively rbind a list of objects:  
```
# create xts time series
x_ts <- xts(x=rnorm(1000), order.by=(Sys.time()-3600*(1:1000)))
# split time series into daily list
list_xts <- split(x_ts, "days")
# rbind the list back into a time series and compare with the original
identical(x_ts, do_call_rbind(list_xts))
```


Recursively apply a function to a list of objects:  
```
# create xts time series
x_ts <- xts(x=rnorm(1000), order.by=(Sys.time()-3600*(1:1000)))
# split time series into daily list
list_xts <- split(x_ts, "days")
# rbind the list back into a time series and compare with the original
identical(x_ts, do_call(rbind, list_xts))
```


Apply a function to a list of objects, merge the outputs into a single object, and assign the object to the output environment:  
```
do_call_assign(
   func_tion=clo_se,
   sym_bols=env_etf$sym_bols,
   out_put="price_s",
   env_in=env_etf, env_out=new_env)
```


Plot an *xts* time series with custom y-axis range and with vertical background shading:  
```
chart_xts(env_etf$VTI["2015-11"],
name="VTI in Nov 2015", ylim=c(102, 108),
in_dex=index(env_etf$VTI["2015-11"]) > as.Date("2015-11-18"))
```

